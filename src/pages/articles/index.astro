---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const title = "Articles";
const description = "Textes latéraux. Incomplets par design.";

const posts = (await getCollection("articles"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<BaseLayout title={title} description={description} bodyClass="articles-index">
  <header class="head">
    <h1>Articles</h1>
    <p class="hint">Textes latéraux. Incomplets par design.</p>
  </header>

  {posts.length === 0 ? (
    <p class="empty">Aucun article publié.</p>
  ) : (
    <ol class="list">
      {posts.map((post) => (
        <li>
          <a class="item" href={`/articles/${post.slug}`}>
            <span class="item-title">{post.data.title}</span>
            <span class="item-meta">
              <time datetime={post.data.date.toISOString()}>
                {post.data.date.toLocaleDateString("fr-FR", {
                  year: "numeric",
                  month: "2-digit",
                  day: "2-digit",
                })}
              </time>
            </span>
          </a>
        </li>
      ))}
    </ol>
  )}

  <style>
    .head { margin-bottom: 1rem; }
    .head h1 { margin: 0; }
    .hint { margin: .35rem 0 0; opacity: .75; max-width: 70ch; }

    .list {
      list-style: none;
      padding: 0;
      margin: 0;
      border-top: 1px solid rgba(0,0,0,.12);
    }
    .list li { border-bottom: 1px solid rgba(0,0,0,.12); }
    .item {
      display: flex;
      gap: 1rem;
      align-items: baseline;
      justify-content: space-between;
      padding: .9rem 0;
      text-decoration: none;
    }
    .item-title { font-weight: 650; }
    .item-meta { opacity: .7; font-size: .95em; white-space: nowrap; }
  </style>
</BaseLayout>
